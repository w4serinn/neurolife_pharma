<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIã‚µãƒãƒ¼ãƒˆ | ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ©ã‚¤ãƒ•è£½è–¬</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+JP:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0a4d68;
            --secondary: #088395;
            --accent: #05c3dd;
            --dark: #051923;
            --light: #f0f9ff;
            --warning: #ff6b6b;
            --success: #51cf66;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior-y: none;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, var(--dark) 0%, var(--primary) 100%);
            color: var(--light);
            min-height: 100vh;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior-y: contain;
        }

        header {
            background: rgba(5, 25, 35, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--accent);
            padding: 1.5rem 2rem;
            box-shadow: 0 4px 20px rgba(5, 195, 221, 0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 0 0 20px rgba(5, 195, 221, 0.5);
            text-decoration: none;
        }

        .logo span {
            color: var(--warning);
            font-size: 0.7rem;
            vertical-align: super;
        }

        nav a {
            color: var(--light);
            text-decoration: none;
            font-weight: 400;
            transition: all 0.3s;
            padding: 0.5rem 1rem;
            border-radius: 4px;
        }

        nav a:hover {
            color: var(--accent);
            background: rgba(5, 195, 221, 0.1);
        }

        .chat-container {
            max-width: 900px;
            width: 100%;
            margin: 2rem auto 4rem auto;
            padding: 0 1rem;
        }

        .chat-header {
            background: rgba(10, 77, 104, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid var(--accent);
            border-bottom: none;
            border-radius: 12px 12px 0 0;
            padding: 1.5rem;
            text-align: center;
        }

        .chat-header h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            color: var(--accent);
            margin-bottom: 0.5rem;
        }

        .chat-header p {
            color: rgba(240, 249, 255, 0.7);
            font-size: 0.9rem;
        }

        .status {
            display: inline-block;
            padding: 0.3rem 1rem;
            background: rgba(81, 207, 102, 0.2);
            border: 1px solid var(--success);
            border-radius: 20px;
            font-size: 0.85rem;
            margin-top: 0.5rem;
        }

        .status::before {
            content: 'â—';
            color: var(--success);
            margin-right: 0.5rem;
            animation: blink 2s infinite;
        }

        @keyframes blink {
            0%, 50%, 100% { opacity: 1; }
            25%, 75% { opacity: 0.3; }
        }

        .chat-messages {
            background: rgba(5, 25, 35, 0.8);
            backdrop-filter: blur(10px);
            border-left: 1px solid var(--accent);
            border-right: 1px solid var(--accent);
            padding: 2rem;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior-y: contain;
            min-height: 400px;
            max-height: 500px;
        }

        .message {
            margin-bottom: 1.5rem;
            display: flex;
            gap: 1rem;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            flex-shrink: 0;
        }

        .bot-avatar {
            background: linear-gradient(135deg, var(--secondary), var(--accent));
            color: var(--dark);
        }

        .user-avatar {
            background: rgba(240, 249, 255, 0.2);
            border: 2px solid var(--light);
            color: var(--light);
        }

        .message-content {
            flex: 1;
        }

        .message-sender {
            font-weight: 600;
            margin-bottom: 0.3rem;
            font-size: 0.9rem;
        }

        .message-text {
            background: rgba(10, 77, 104, 0.3);
            padding: 1rem;
            border-radius: 8px;
            border-left: 3px solid var(--accent);
            line-height: 1.6;
        }

        .user-message .message-text {
            background: rgba(240, 249, 255, 0.1);
            border-left-color: var(--light);
        }

        .warning-message .message-text {
            background: rgba(255, 107, 107, 0.1);
            border-left-color: var(--warning);
            color: var(--warning);
        }

        .chat-input-container {
            background: rgba(10, 77, 104, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid var(--accent);
            border-top: none;
            border-bottom: none;
            padding: 1.5rem;
            display: flex;
            gap: 1rem;
        }

        #userInput {
            flex: 1;
            background: rgba(5, 25, 35, 0.8);
            border: 1px solid var(--accent);
            border-radius: 8px;
            padding: 1rem;
            color: var(--light);
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s;
        }

        #userInput:focus {
            border-color: var(--light);
            box-shadow: 0 0 15px rgba(5, 195, 221, 0.3);
        }

        #sendButton {
            background: linear-gradient(135deg, var(--secondary), var(--accent));
            color: var(--dark);
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Orbitron', sans-serif;
        }

        #sendButton:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(5, 195, 221, 0.4);
        }

        #sendButton:active {
            transform: translateY(0);
        }

        .typing-indicator {
            display: none;
            align-items: center;
            gap: 0.5rem;
            color: var(--accent);
            font-style: italic;
            font-size: 0.9rem;
            padding: 0 1.5rem;
        }

        .typing-indicator.active {
            display: flex;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--accent);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        .quick-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        .quick-action {
            background: rgba(5, 195, 221, 0.2);
            border: 1px solid var(--accent);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quick-action:hover {
            background: rgba(5, 195, 221, 0.4);
            transform: translateY(-2px);
        }

        /* AI Summary Section */
        .ai-summary {
            background: rgba(10, 77, 104, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid var(--accent);
            border-radius: 0 0 12px 12px;
            overflow: hidden;
            touch-action: pan-y;
        }

        .summary-header {
            padding: 1rem 1.5rem;
            background: rgba(5, 25, 35, 0.6);
            border-bottom: 1px solid rgba(5, 195, 221, 0.3);
            cursor: pointer;
            transition: all 0.3s;
        }

        .summary-header:hover {
            background: rgba(5, 25, 35, 0.8);
        }

        .summary-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .summary-title {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            color: var(--accent);
        }

        .summary-icon {
            font-size: 1.2rem;
            animation: rotate 3s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .summary-toggle {
            font-size: 1.5rem;
            color: var(--accent);
            transition: transform 0.3s;
        }

        .summary-toggle.expanded {
            transform: rotate(180deg);
        }

        .summary-hint {
            font-size: 0.75rem;
            color: rgba(240, 249, 255, 0.6);
            margin-top: 0.5rem;
            line-height: 1.5;
        }

        .summary-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-out;
        }

        .summary-content.expanded {
            max-height: 80vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .summary-section {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(5, 195, 221, 0.1);
            touch-action: pan-y;
        }

        .summary-section:last-child {
            border-bottom: none;
        }

        .summary-section-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem;
            color: var(--success);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .summary-badge {
            background: rgba(81, 207, 102, 0.2);
            border: 1px solid var(--success);
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-family: 'Orbitron', sans-serif;
        }

        .summary-item {
            background: rgba(5, 25, 35, 0.6);
            border: 1px solid rgba(5, 195, 221, 0.2);
            border-radius: 6px;
            padding: 0.8rem 1rem;
            margin-bottom: 0.8rem;
            display: flex;
            flex-wrap: wrap;
            align-items: flex-start;
            gap: 0.8rem;
            transition: all 0.3s;
            cursor: pointer;
            min-height: auto;
        }

        .summary-item:hover {
            border-color: var(--accent);
            background: rgba(5, 25, 35, 0.8);
            transform: translateX(5px);
        }

        .summary-item:active {
            transform: translateX(5px) scale(0.98);
        }

        .summary-item-icon {
            font-size: 1rem;
        }

        .summary-item-text {
            flex: 1;
            font-size: 0.9rem;
            min-width: 0;
            word-wrap: break-word;
        }

        .summary-item-time {
            font-size: 0.75rem;
            color: rgba(240, 249, 255, 0.5);
            font-family: 'Orbitron', monospace;
        }

        .memo-icon {
            font-size: 1rem;
            cursor: pointer;
            padding: 0.5rem;
            margin: -0.5rem;
            border-radius: 4px;
            transition: all 0.3s;
            color: rgba(240, 249, 255, 0.5);
            flex-shrink: 0;
            min-width: 40px;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .memo-icon:hover {
            background: rgba(5, 195, 221, 0.2);
            color: var(--accent);
        }

        .memo-icon.has-memo {
            color: var(--success);
        }

        .summary-item-memo {
            background: rgba(5, 195, 221, 0.1);
            border-left: 2px solid var(--accent);
            padding: 0.5rem 0.8rem;
            margin-top: 0.5rem;
            font-size: 0.85rem;
            line-height: 1.5;
            color: rgba(240, 249, 255, 0.9);
            border-radius: 4px;
            width: 100%;
            word-wrap: break-word;
            white-space: pre-wrap;
        }

        .empty-state {
            text-align: center;
            padding: 2rem;
            color: rgba(240, 249, 255, 0.5);
            font-size: 0.9rem;
        }

        .clear-button {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid var(--warning);
            color: var(--warning);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Orbitron', sans-serif;
            margin-top: 1rem;
        }

        .clear-button:hover {
            background: rgba(255, 107, 107, 0.3);
            transform: translateY(-2px);
        }

        /* Memo Modal */
        .memo-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .memo-modal.active {
            display: flex;
        }

        .memo-modal-content {
            background: linear-gradient(135deg, var(--dark), var(--primary));
            border: 2px solid var(--accent);
            border-radius: 12px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 50px rgba(5, 195, 221, 0.3);
        }

        .memo-modal-header {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            color: var(--accent);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .memo-item-name {
            font-size: 0.9rem;
            color: rgba(240, 249, 255, 0.7);
            margin-bottom: 1rem;
            padding: 0.5rem;
            background: rgba(5, 195, 221, 0.1);
            border-radius: 4px;
        }

        .memo-textarea {
            width: 100%;
            min-height: 120px;
            background: rgba(5, 25, 35, 0.8);
            border: 1px solid var(--accent);
            border-radius: 8px;
            padding: 1rem;
            color: var(--light);
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 0.9rem;
            resize: vertical;
            outline: none;
        }

        .memo-textarea:focus {
            border-color: var(--light);
            box-shadow: 0 0 15px rgba(5, 195, 221, 0.3);
        }

        .memo-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .memo-btn {
            flex: 1;
            padding: 0.8rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Orbitron', sans-serif;
        }

        .memo-btn-cancel {
            background: rgba(240, 249, 255, 0.1);
            border: 1px solid var(--light);
            color: var(--light);
        }

        .memo-btn-cancel:hover {
            background: rgba(240, 249, 255, 0.2);
        }

        .memo-btn-save {
            background: linear-gradient(135deg, var(--secondary), var(--accent));
            border: none;
            color: var(--dark);
        }

        .memo-btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(5, 195, 221, 0.4);
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .notice-banner {
                font-size: 0.8rem !important;
                padding: 0.8rem !important;
                line-height: 1.5 !important;
            }

            header {
                padding: 1rem;
            }

            .header-content {
                flex-direction: column;
                gap: 0.5rem;
                align-items: flex-start;
            }

            .logo {
                font-size: 1.3rem;
            }

            nav a {
                padding: 0.4rem 0.8rem;
                font-size: 0.9rem;
            }

            .chat-container {
                margin: 1rem auto 2rem auto;
                padding: 0 0.5rem;
            }

            .chat-header h1 {
                font-size: 1.3rem;
            }

            .chat-header p {
                font-size: 0.8rem;
            }

            .chat-messages {
                padding: 1rem;
                min-height: 300px;
                max-height: 400px;
            }

            .message-text {
                font-size: 0.9rem;
                padding: 0.8rem;
            }

            .chat-input-container {
                padding: 1rem;
                flex-direction: column;
            }

            #userInput {
                font-size: 0.9rem;
            }

            #sendButton {
                width: 100%;
                padding: 0.8rem;
            }

            .quick-actions {
                flex-direction: column;
            }

            .quick-action {
                width: 100%;
                text-align: center;
            }

            .summary-section {
                padding: 1rem;
            }

            .summary-item {
                flex-wrap: wrap;
                align-items: flex-start;
                gap: 0.5rem;
                position: relative;
                padding-right: 50px;
            }

            .summary-item .memo-icon {
                position: absolute;
                right: 0;
                top: 0.5rem;
            }

            .summary-item-text {
                width: calc(100% - 60px);
            }

            .summary-item:hover {
                transform: none;
            }

            .summary-item:active {
                transform: scale(0.98);
            }

            .summary-content.expanded {
                max-height: 70vh;
            }

            .memo-modal-content {
                width: 95%;
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Notice Banner -->
    <div class="notice-banner" style="background: rgba(255, 107, 107, 0.2); border-bottom: 2px solid var(--warning); padding: 1rem; text-align: center; font-size: 0.95rem; color: var(--warning); backdrop-filter: blur(10px); line-height: 1.6;">
        âš ï¸ è«¸äº‹æƒ…ã«ã‚ˆã‚Šæœ¬ãƒšãƒ¼ã‚¸ã®æ›´æ–°ã¯æ­¢ã¾ã£ã¦ãŠã‚Šã¾ã™ã€‚æ–°ã‚µã‚¤ãƒˆã®é–‹è¨­ã‚’ãŠå¾…ã¡ãã ã•ã„ã€‚<br>
        ãªãŠã€AIã‚µãƒãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ã«ã¤ã„ã¦ã¯2024å¹´11æœˆã¾ã§ã®æƒ…å ±ã§ã™ãŒç¨¼åƒã„ãŸã—ã¾ã™ã€‚
    </div>

    <header>
        <div class="header-content">
            <a href="company-site.html" class="logo">NeuroLife<span style="font-size: 0.5em; font-weight: 400; margin-left: 0.3rem;">Pharmaceuticals</span><span data-hint="NL-X789">Â®</span></a>
            <nav>
                <a href="company-site.html">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a>
            </nav>
        </div>
    </header>

    <div class="chat-container">
        <div class="chat-header">
            <h1>AIã‚µãƒãƒ¼ãƒˆ ã‚·ã‚¹ãƒ†ãƒ </h1>
            <p>ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ©ã‚¤ãƒ•è£½è–¬ ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆ AI v3.7.2</p>
            <div class="status">ã‚ªãƒ³ãƒ©ã‚¤ãƒ³</div>
        </div>

        <div class="chat-messages" id="chatMessages">
            <div class="message bot-message">
                <div class="message-avatar bot-avatar">NL</div>
                <div class="message-content">
                    <div class="message-sender">NeuroLife AI</div>
                    <div class="message-text">
                        ã“ã‚“ã«ã¡ã¯ã€‚ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ©ã‚¤ãƒ•è£½è–¬ã®AIã‚µãƒãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚<br>
                        è£½å“ã«é–¢ã™ã‚‹ã”è³ªå•ã‚„ã€ç ”ç©¶é–‹ç™ºã«ã¤ã„ã¦ã®ãŠå•ã„åˆã‚ã›ã«ãŠç­”ãˆã—ã¾ã™ã€‚<br><br>
                        ãŠæ°—è»½ã«ã”è³ªå•ãã ã•ã„ã€‚
                    </div>
                    <div class="quick-actions">
                        <div class="quick-action" onclick="sendQuickMessage('è£½å“ã«ã¤ã„ã¦')">è£½å“ã«ã¤ã„ã¦</div>
                        <div class="quick-action" onclick="sendQuickMessage('ç ”ç©¶é–‹ç™º')">ç ”ç©¶é–‹ç™º</div>
                        <div class="quick-action" onclick="sendQuickMessage('ä¼šç¤¾æƒ…å ±')">ä¼šç¤¾æƒ…å ±</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="typing-indicator" id="typingIndicator">
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
            <span>å…¥åŠ›ä¸­...</span>
        </div>

        <div class="chat-input-container">
            <input type="text" id="userInput" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..." onkeypress="handleKeyPress(event)">
            <button id="sendButton" onclick="sendMessage()">é€ä¿¡</button>
        </div>

        <!-- AI Summary Section -->
        <div class="ai-summary">
            <div class="summary-header" onclick="toggleSummary()">
                <div class="summary-header-content">
                    <div class="summary-title">
                        <span class="summary-icon">ğŸ¤–</span>
                        <span>AI è‡ªå‹•åˆ†æãƒ¬ãƒãƒ¼ãƒˆ</span>
                    </div>
                    <span class="summary-toggle" id="summaryToggle">â–¼</span>
                </div>
                <div class="summary-hint">
                    ğŸ’¡ AIã«ã‚ˆã‚‹æ¤œç´¢çµæœã®åˆ†æãŒã“ã¡ã‚‰ã«è¡¨ç¤ºã•ã‚Œã¾ã™<br>
                    ğŸ’¬ å³ä¸Šã®é‰›ç­†ãƒãƒ¼ã‚¯ã‹ã‚‰æ¤œç´¢çµæœã«å¯¾ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å…¥åŠ›ã§ãã¾ã™ã€‚AIã®ç²¾åº¦å‘ä¸Šã«ã¤ãªãŒã‚Šã¾ã™ã®ã§ã”å”åŠ›ãã ã•ã„ã€‚
                </div>
            </div>
            <div class="summary-content" id="summaryContent">
                <div class="summary-section">
                    <div class="summary-section-title">
                        ğŸ” æ¤œç´¢å±¥æ­´ï¼ˆæœ€æ–°10ä»¶ï¼‰
                        <span class="summary-badge" id="searchCount">0</span>
                    </div>
                    <div id="searchHistory">
                        <div class="empty-state">ã¾ã æ¤œç´¢å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“</div>
                    </div>
                </div>
                <div class="summary-section">
                    <div class="summary-section-title">
                        ğŸ” ç™ºè¦‹ã—ãŸèªè¨¼æƒ…å ±
                        <span class="summary-badge" id="authCount">0</span>
                    </div>
                    <div id="authDiscoveries">
                        <div class="empty-state">èªè¨¼æƒ…å ±ã¯è¦‹ã¤ã‹ã£ã¦ã„ã¾ã›ã‚“</div>
                    </div>
                </div>
                <div class="summary-section">
                    <div class="summary-section-title">
                        ğŸ”— ç™ºè¦‹ã—ãŸã‚µã‚¤ãƒˆ
                        <span class="summary-badge" id="linkCount">0</span>
                    </div>
                    <div id="discoveredLinks">
                        <div class="empty-state">ã‚µã‚¤ãƒˆã¯ã¾ã ç™ºè¦‹ã•ã‚Œã¦ã„ã¾ã›ã‚“</div>
                    </div>
                </div>
                <div class="summary-section">
                    <div class="summary-section-title">
                        ğŸ“Œ é‡è¦ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
                        <span class="summary-badge" id="keywordCount">0</span>
                    </div>
                    <div id="importantKeywords">
                        <div class="empty-state">é‡è¦ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ã¾ã æ¤œå‡ºã•ã‚Œã¦ã„ã¾ã›ã‚“</div>
                    </div>
                    <button class="clear-button" onclick="clearAllData()">ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Memo Modal -->
    <div class="memo-modal" id="memoModal">
        <div class="memo-modal-content">
            <div class="memo-modal-header">
                <span>ğŸ“</span>
                <span>ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è¿½åŠ </span>
            </div>
            <div class="memo-item-name" id="memoItemName"></div>
            <textarea class="memo-textarea" id="memoTextarea" placeholder="ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...&#10;ä¾‹ï¼šãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã§ç™ºè¦‹ã€è£½å“ã‚³ãƒ¼ãƒ‰ã«é–¢é€£ã€èª¿æŸ»ãŒå¿…è¦"></textarea>
            <div class="memo-buttons">
                <button class="memo-btn memo-btn-cancel" onclick="closeMemoModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                <button class="memo-btn memo-btn-save" onclick="saveMemo()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <footer style="text-align: center; padding: 2rem; background: rgba(5, 25, 35, 0.9); border-top: 1px solid var(--accent); margin-top: 4rem; font-size: 0.9rem; opacity: 0.8;">
        <p>&copy; 2025 ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ©ã‚¤ãƒ•è£½è–¬æ ªå¼ä¼šç¤¾ All rights reserved.</p>
        <p style="margin-top: 0.5rem; font-size: 0.8rem; opacity: 0.6;">
            æœ¬ã‚µã‚¤ãƒˆã®æƒ…å ±ã¯åŒ»ç™‚å¾“äº‹è€…å‘ã‘ã§ã™ | ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ | åˆ©ç”¨è¦ç´„
        </p>
    </footer>

    <script>
        // ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã®å¿œç­”ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
        const responses = {
            'ã“ã‚“ã«ã¡ã¯': 'ã“ã‚“ã«ã¡ã¯!æœ¬æ—¥ã¯ã©ã®ã‚ˆã†ãªã”ç”¨ä»¶ã§ã—ã‚‡ã†ã‹?',
            'ã¯ã˜ã‚ã¾ã—ã¦': 'ã¯ã˜ã‚ã¾ã—ã¦ã€‚ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ©ã‚¤ãƒ•è£½è–¬ã¸ã‚ˆã†ã“ãã€‚',
            'ã‚ã‚ŠãŒã¨ã†': 'ã©ã†ã„ãŸã—ã¾ã—ã¦ã€‚ä»–ã«ã”è³ªå•ã¯ã”ã–ã„ã¾ã™ã‹?',
            'è£½å“ã«ã¤ã„ã¦': 'å½“ç¤¾ã®ä¸»è¦è£½å“ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™:\n\nâ€¢ NeuroSyncâ„¢ - èªçŸ¥æ©Ÿèƒ½å‘ä¸Š\nâ€¢ MemoriaPlusâ„¢ - è¨˜æ†¶å¢—å¼·\nâ€¢ DreamLinkâ„¢ - ç¡çœ èª¿æ•´\n\nè©³ç´°ã‚’ãŠçŸ¥ã‚Šã«ãªã‚ŠãŸã„è£½å“åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',
            'neurosync': 'NeuroSyncâ„¢ã¯è„³ç¥çµŒã®æœ€é©åŒ–ã«ã‚ˆã‚ŠèªçŸ¥æ©Ÿèƒ½ã‚’å‘ä¸Šã•ã›ã‚‹è£½å“ã§ã™ã€‚\nè£½å“ã‚³ãƒ¼ãƒ‰: NS-2847-ALPHA\n\nâ€»ç¾åœ¨ã€é™å®šçš„ãªè‡¨åºŠè©¦é¨“æ®µéšã«ã‚ã‚Šã¾ã™ã€‚',
            'memoriaplus': 'MemoriaPlusâ„¢ã¯é•·æœŸè¨˜æ†¶ã®å½¢æˆã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹è£½å“ã§ã™ã€‚\nè£½å“ã‚³ãƒ¼ãƒ‰: MP-1923-BETA\n\nä¸€èˆ¬å‘ã‘ã«ã¯2026å¹´æ˜¥ã®è²©å£²é–‹å§‹ã‚’äºˆå®šã—ã¦ã„ã¾ã™ã€‚',
            'dreamlink': 'DreamLinkâ„¢ã¯ç¡çœ ã®è³ªã‚’å‘ä¸Šã•ã›ã€æ˜æ™°å¤¢ã‚’èª˜å°ã™ã‚‹è£½å“ã§ã™ã€‚\nè£½å“ã‚³ãƒ¼ãƒ‰: DL-X789-OMEGA\n\nâš ï¸ è­¦å‘Š: ã“ã®è£½å“ã¯ç¾åœ¨ã€å³æ ¼ãªç›£è¦–ä¸‹ã§ã®è‡¨åºŠè©¦é¨“æ®µéšã§ã™ã€‚ä¸€èˆ¬ä½¿ç”¨ã¯ç¦æ­¢ã•ã‚Œã¦ã„ã¾ã™ã€‚',
            'dl-x789-omega': 'âš ï¸ ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™\n\nè£½å“ã‚³ãƒ¼ãƒ‰ DL-X789-OMEGA ã®è©³ç´°æƒ…å ±ã¯ç¾åœ¨ç¤¾å†…é™å®šã§ã™ã€‚\né–‹ç™ºä¸­ã®ç¤¾å†…æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ ã‚µã‚¤ãƒˆã‚ˆã‚Šã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„ã€‚',
            'dl-x789': 'âš ï¸ ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™\n\nè£½å“ã‚³ãƒ¼ãƒ‰ DL-X789-OMEGA ã®è©³ç´°æƒ…å ±ã¯ç¾åœ¨ç¤¾å†…é™å®šã§ã™ã€‚\né–‹ç™ºä¸­ã®ç¤¾å†…æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ ã‚µã‚¤ãƒˆã‚ˆã‚Šã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„ã€‚',
            'x789': 'âš ï¸ ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™\n\nè£½å“ã‚³ãƒ¼ãƒ‰ DL-X789-OMEGA ã®è©³ç´°æƒ…å ±ã¯ç¾åœ¨ç¤¾å†…é™å®šã§ã™ã€‚\né–‹ç™ºä¸­ã®ç¤¾å†…æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ ã‚µã‚¤ãƒˆã‚ˆã‚Šã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„ã€‚',
            'ç ”ç©¶é–‹ç™º': 'å½“ç¤¾ã¯ä»¥ä¸‹ã®åˆ†é‡ã§ç ”ç©¶é–‹ç™ºã‚’è¡Œã£ã¦ã„ã¾ã™:\n\nâ€¢ ç¥çµŒå¯å¡‘æ€§ã®å¢—å¼·\nâ€¢ è¨˜æ†¶ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®æœ€é©åŒ–\nâ€¢ å¤¢ã¨æ„è­˜ã®ç§‘å­¦çš„è§£æ˜\n\nè©³ç´°ã«ã¤ã„ã¦ã¯å…¬å¼ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã‚’ã”è¦§ãã ã•ã„ã€‚',
            'æ–°ã‚µã‚¤ãƒˆ': 'ç¤¾å†…æ©Ÿå¯†æƒ…å ±ã‚’ç¢ºèªã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®å½¢å¼ã€åŠè§’è‹±å­—ã§å…¥åŠ›ãã ã•ã„ã€‚\n\nãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ XXXX',
            'ç¤¾å†…æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ ã‚µã‚¤ãƒˆ': 'ç¤¾å†…æ©Ÿå¯†æƒ…å ±ã‚’ç¢ºèªã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®å½¢å¼ã€åŠè§’è‹±å­—ã§å…¥åŠ›ãã ã•ã„ã€‚\n\nãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ XXXX',
            'è‡¨åºŠè©¦é¨“': 'è‡¨åºŠè©¦é¨“å‚åŠ è€…ã®æ–¹ã«ã¤ãã¾ã—ã¦ã¯éƒµé€ã•ã‚ŒãŸæ‰‹ç´™è¨˜è¼‰ã®ID,ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã€Œè‡¨åºŠè©¦é¨“è¢«é¨“è€…ã®æ–¹ã¸ã€ã®ãƒšãƒ¼ã‚¸ã‹ã‚‰å…¥åŠ›ã„ãŸã ã‘ã¾ã™ã‚ˆã†ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚',
            'è‡¨åºŠè©¦é¨“è¢«é¨“è€…ã®æ–¹ã¸': 'ã€Œè‡¨åºŠè©¦é¨“è¢«é¨“è€…ã®æ–¹ã¸ã€ã®ãƒšãƒ¼ã‚¸ã«ã¤ã„ã¦ã€ç¾åœ¨æ–°ã‚µã‚¤ãƒˆã¸ã®ç§»ç®¡ã‚’è¨ˆç”»ä¸­ã§ã™ã€‚URLã«ã¤ãã¾ã—ã¦ã¯åˆ¥é€”éƒµé€ã„ãŸã—ã¾ã™ã€‚',
            'nemophila': 'âœ“ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼æˆåŠŸ\n\nã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã—ã¾ã™ã€‚\n\næ–°ã‚µã‚¤ãƒˆã¯ã“ã¡ã‚‰:\n<a href="newsite.html" style="color: var(--accent); text-decoration: underline;">https://neurolife-pharma.com/internal</a>',
            'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ nemophila': 'âœ“ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼æˆåŠŸ\n\nã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã—ã¾ã™ã€‚\n\næ–°ã‚µã‚¤ãƒˆã¯ã“ã¡ã‚‰:\n<a href="newsite.html" style="color: var(--accent); text-decoration: underline;">https://neurolife-pharma.com/internal</a>',
            'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰': 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯<span style="color: #05c3dd;">12</span><span style="color: #ff6b6b;">5</span><span style="color: #05c3dd;">5</span><span style="color: #ff6b6b;">12</span><span style="color: #05c3dd;">76</span><span style="color: #ff6b6b;">3</span>\n\n<span style="color: #ff6b6b;">5</span><span style="color: #05c3dd;">9</span><span style="color: #ff6b6b;">5</span><span style="color: #05c3dd;">5</span> ->ãƒ¡ãƒ¢\n<span style="color: #ff6b6b;">723</span><span style="color: #05c3dd;">745</span>->èŒ¶è‰²\n<span style="color: #ff6b6b;">5372</span><span style="color: #05c3dd;">71</span><span style="color: #ff6b6b;">65</span><span style="color: #05c3dd;">7</span> -> è¡—ä¸¦ã¿',
            'ä¼šç¤¾æƒ…å ±': 'ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ©ã‚¤ãƒ•è£½è–¬æ ªå¼ä¼šç¤¾\nè¨­ç«‹: 2015å¹´\næœ¬ç¤¾: æ±äº¬\nå¾“æ¥­å“¡æ•°: 347å\n\nãƒŸãƒƒã‚·ãƒ§ãƒ³: äººé–“ã®æ½œåœ¨èƒ½åŠ›ã‚’è§£æ”¾ã™ã‚‹\n\nè©³ç´°ã«ã¤ã„ã¦ã¯å…¬å¼ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã‚’ã”è¦§ãã ã•ã„ã€‚',
            'default': 'ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€‚ãã®è³ªå•ã«ã¯å›ç­”ã§ãã¾ã›ã‚“ã€‚\n\nä»¥ä¸‹ã®ãƒˆãƒ”ãƒƒã‚¯ã«ã¤ã„ã¦ãŠç­”ãˆã§ãã¾ã™:\nâ€¢ è£½å“ã«ã¤ã„ã¦\nâ€¢ ç ”ç©¶é–‹ç™º\nâ€¢ ä¼šç¤¾æƒ…å ±\n\nã¾ãŸã¯ã€ç‰¹å®šã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ã¿ã¦ãã ã•ã„ã€‚'
        };

        // èªè¨¼é–¢é€£ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: è¡¨ç¤ºåï¼‰
        const authKeywords = {
            'nemophila': 'ç¤¾å†…æƒ…å ±ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰',
            'dl-x789-omega': 'åˆ¶é™è£½å“ã‚³ãƒ¼ãƒ‰'
        };

        // é‡è¦ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆ
        const importantKeywords = [
            'nemophila',
            'dl-x789-omega',
            'x789',
            'è‡¨åºŠè©¦é¨“',
            'è¢«é¨“è€…',
            '2847'
        ];

        // ç™ºè¦‹å¯èƒ½ãªã‚µã‚¤ãƒˆã®ãƒãƒƒãƒ”ãƒ³ã‚°
        const siteLinks = {
            'newsite.html': 'ç¤¾å†…æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ ï¼ˆæ§‹ç¯‰ä¸­ï¼‰',
            'clinical-trial.html': 'è‡¨åºŠè©¦é¨“è¢«é¨“è€…ãƒšãƒ¼ã‚¸',
            'research.html': 'ç ”ç©¶é–‹ç™ºè³‡æ–™',
            'protocol.html': 'ãƒ—ãƒ­ãƒˆã‚³ãƒ«æ–‡æ›¸'
        };

        // ãƒ¡ãƒ¢ãƒ¢ãƒ¼ãƒ€ãƒ«ã®çŠ¶æ…‹ç®¡ç†
        let currentMemoType = null;
        let currentMemoItem = null;

        // HTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—é–¢æ•°
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // LocalStorageã‹ã‚‰å±¥æ­´ã‚’èª­ã¿è¾¼ã¿
        function loadHistory() {
            const searches = JSON.parse(localStorage.getItem('chatbot_searches') || '[]');
            const auths = JSON.parse(localStorage.getItem('chatbot_auths') || '[]');
            const links = JSON.parse(localStorage.getItem('chatbot_links') || '[]');
            const keywords = JSON.parse(localStorage.getItem('chatbot_keywords') || '[]');
            
            updateSearchHistory(searches);
            updateAuthDiscoveries(auths);
            updateDiscoveredLinks(links);
            updateImportantKeywords(keywords);
        }

        // æ¤œç´¢å±¥æ­´ã‚’ä¿å­˜
        function saveSearch(query) {
            const searches = JSON.parse(localStorage.getItem('chatbot_searches') || '[]');
            const timestamp = new Date().toLocaleTimeString('ja-JP', {hour: '2-digit', minute: '2-digit'});
            
            searches.unshift({query, timestamp});
            if (searches.length > 10) searches.pop();
            
            localStorage.setItem('chatbot_searches', JSON.stringify(searches));
            updateSearchHistory(searches);
        }

        // èªè¨¼æƒ…å ±ã‚’ä¿å­˜
        function saveAuth(info, type) {
            const auths = JSON.parse(localStorage.getItem('chatbot_auths') || '[]');
            const timestamp = new Date().toLocaleTimeString('ja-JP', {hour: '2-digit', minute: '2-digit'});
            
            if (!auths.some(a => a.info === info)) {
                auths.unshift({info, type, timestamp});
                localStorage.setItem('chatbot_auths', JSON.stringify(auths));
                updateAuthDiscoveries(auths);
            }
        }

        // é‡è¦ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ä¿å­˜
        function saveKeyword(keyword) {
            const keywords = JSON.parse(localStorage.getItem('chatbot_keywords') || '[]');
            const timestamp = new Date().toLocaleTimeString('ja-JP', {hour: '2-digit', minute: '2-digit'});
            
            if (!keywords.some(k => k.keyword === keyword)) {
                keywords.unshift({keyword, timestamp});
                if (keywords.length > 15) keywords.pop();
                localStorage.setItem('chatbot_keywords', JSON.stringify(keywords));
                updateImportantKeywords(keywords);
            }
        }

        // ã‚µã‚¤ãƒˆãƒªãƒ³ã‚¯ã‚’ä¿å­˜
        function saveLink(url, description) {
            const links = JSON.parse(localStorage.getItem('chatbot_links') || '[]');
            const timestamp = new Date().toLocaleTimeString('ja-JP', {hour: '2-digit', minute: '2-digit'});
            
            if (!links.some(l => l.url === url)) {
                links.unshift({url, description, timestamp});
                localStorage.setItem('chatbot_links', JSON.stringify(links));
                updateDiscoveredLinks(links);
            }
        }

        // æ¤œç´¢å±¥æ­´ã®è¡¨ç¤ºã‚’æ›´æ–°
        function updateSearchHistory(searches) {
            const container = document.getElementById('searchHistory');
            document.getElementById('searchCount').textContent = searches.length;
            
            if (searches.length === 0) {
                container.innerHTML = '<div class="empty-state">ã¾ã æ¤œç´¢å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“</div>';
                return;
            }
            
            container.innerHTML = '';
            searches.forEach((s, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'summary-item';
                
                const memoClass = s.memo ? 'has-memo' : '';
                
                itemDiv.innerHTML = `
                    <span class="summary-item-icon">ğŸ”</span>
                    <span class="summary-item-text">${escapeHtml(s.query)}</span>
                    <span class="summary-item-time">${s.timestamp}</span>
                    <span class="memo-icon ${memoClass}" title="ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è¿½åŠ ">ğŸ“</span>
                `;
                
                if (s.memo) {
                    const memoDiv = document.createElement('div');
                    memoDiv.className = 'summary-item-memo';
                    memoDiv.textContent = s.memo;
                    memoDiv.style.width = '100%';
                    itemDiv.appendChild(memoDiv);
                }
                
                // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆãƒ¡ãƒ¢ä»¥å¤–ï¼‰
                itemDiv.onclick = (e) => {
                    if (!e.target.classList.contains('memo-icon')) {
                        fillSearchInput(s.query);
                    }
                };
                
                const memoBtn = itemDiv.querySelector('.memo-icon');
                memoBtn.onclick = (e) => {
                    e.stopPropagation();
                    openMemoModal('searches', s, 'æ¤œç´¢: ' + s.query);
                };
                
                container.appendChild(itemDiv);
            });
        }

        // èªè¨¼æƒ…å ±ã®è¡¨ç¤ºã‚’æ›´æ–°
        function updateAuthDiscoveries(auths) {
            const container = document.getElementById('authDiscoveries');
            document.getElementById('authCount').textContent = auths.length;
            
            if (auths.length === 0) {
                container.innerHTML = '<div class="empty-state">èªè¨¼æƒ…å ±ã¯è¦‹ã¤ã‹ã£ã¦ã„ã¾ã›ã‚“</div>';
                return;
            }
            
            container.innerHTML = '';
            auths.forEach((a, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'summary-item';
                
                const memoClass = a.memo ? 'has-memo' : '';
                
                itemDiv.innerHTML = `
                    <span class="summary-item-icon">ğŸ”</span>
                    <span class="summary-item-text">${escapeHtml(a.info)} <span style="color: var(--success); font-size: 0.8rem;">[${escapeHtml(a.type)}]</span></span>
                    <span class="summary-item-time">${a.timestamp}</span>
                    <span class="memo-icon ${memoClass}" title="ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è¿½åŠ ">ğŸ“</span>
                `;
                
                if (a.memo) {
                    const memoDiv = document.createElement('div');
                    memoDiv.className = 'summary-item-memo';
                    memoDiv.textContent = a.memo;
                    memoDiv.style.width = '100%';
                    itemDiv.appendChild(memoDiv);
                }
                
                itemDiv.onclick = (e) => {
                    if (!e.target.classList.contains('memo-icon')) {
                        fillSearchInput(a.info);
                    }
                };
                
                const memoBtn = itemDiv.querySelector('.memo-icon');
                memoBtn.onclick = (e) => {
                    e.stopPropagation();
                    openMemoModal('auths', a, 'èªè¨¼æƒ…å ±: ' + a.info);
                };
                
                container.appendChild(itemDiv);
            });
        }

        // é‡è¦ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®è¡¨ç¤ºã‚’æ›´æ–°
        function updateImportantKeywords(keywords) {
            const container = document.getElementById('importantKeywords');
            document.getElementById('keywordCount').textContent = keywords.length;
            
            if (keywords.length === 0) {
                container.innerHTML = '<div class="empty-state">é‡è¦ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ã¾ã æ¤œå‡ºã•ã‚Œã¦ã„ã¾ã›ã‚“</div>';
                return;
            }
            
            container.innerHTML = '';
            keywords.forEach((k, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'summary-item';
                
                const memoClass = k.memo ? 'has-memo' : '';
                
                itemDiv.innerHTML = `
                    <span class="summary-item-icon">ğŸ“Œ</span>
                    <span class="summary-item-text">${escapeHtml(k.keyword)}</span>
                    <span class="summary-item-time">${k.timestamp}</span>
                    <span class="memo-icon ${memoClass}" title="ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è¿½åŠ ">ğŸ“</span>
                `;
                
                if (k.memo) {
                    const memoDiv = document.createElement('div');
                    memoDiv.className = 'summary-item-memo';
                    memoDiv.textContent = k.memo;
                    memoDiv.style.width = '100%';
                    itemDiv.appendChild(memoDiv);
                }
                
                itemDiv.onclick = (e) => {
                    if (!e.target.classList.contains('memo-icon')) {
                        fillSearchInput(k.keyword);
                    }
                };
                
                const memoBtn = itemDiv.querySelector('.memo-icon');
                memoBtn.onclick = (e) => {
                    e.stopPropagation();
                    openMemoModal('keywords', k, 'ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: ' + k.keyword);
                };
                
                container.appendChild(itemDiv);
            });
        }

        // ç™ºè¦‹ã—ãŸã‚µã‚¤ãƒˆã®è¡¨ç¤ºã‚’æ›´æ–°
        function updateDiscoveredLinks(links) {
            const container = document.getElementById('discoveredLinks');
            document.getElementById('linkCount').textContent = links.length;
            
            if (links.length === 0) {
                container.innerHTML = '<div class="empty-state">ã‚µã‚¤ãƒˆã¯ã¾ã ç™ºè¦‹ã•ã‚Œã¦ã„ã¾ã›ã‚“</div>';
                return;
            }
            
            container.innerHTML = '';
            links.forEach((l, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'summary-item';
                itemDiv.style.cursor = 'pointer';
                
                const memoClass = l.memo ? 'has-memo' : '';
                
                itemDiv.innerHTML = `
                    <span class="summary-item-icon">ğŸ”—</span>
                    <span class="summary-item-text">
                        <strong style="color: var(--accent);">${escapeHtml(l.description)}</strong><br>
                        <span style="font-size: 0.8rem; opacity: 0.7;">${escapeHtml(l.url)}</span>
                    </span>
                    <span class="summary-item-time">${l.timestamp}</span>
                    <span class="memo-icon ${memoClass}" title="ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è¿½åŠ ">ğŸ“</span>
                `;
                
                if (l.memo) {
                    const memoDiv = document.createElement('div');
                    memoDiv.className = 'summary-item-memo';
                    memoDiv.textContent = l.memo;
                    memoDiv.style.width = '100%';
                    itemDiv.appendChild(memoDiv);
                }
                
                itemDiv.onclick = (e) => {
                    if (!e.target.classList.contains('memo-icon')) {
                        window.open(l.url, '_blank');
                    }
                };
                
                const memoBtn = itemDiv.querySelector('.memo-icon');
                memoBtn.onclick = (e) => {
                    e.stopPropagation();
                    openMemoModal('links', l, 'ã‚µã‚¤ãƒˆ: ' + l.description);
                };
                
                container.appendChild(itemDiv);
            });
        }

        // ãƒ¡ãƒ¢ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
        function openMemoModal(type, item, itemName) {
            currentMemoType = type;
            currentMemoItem = item;
            
            document.getElementById('memoItemName').textContent = itemName;
            document.getElementById('memoTextarea').value = item.memo || '';
            document.getElementById('memoModal').classList.add('active');
        }

        // ãƒ¡ãƒ¢ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        function closeMemoModal() {
            document.getElementById('memoModal').classList.remove('active');
            currentMemoType = null;
            currentMemoItem = null;
        }

        // ãƒ¡ãƒ¢ã‚’ä¿å­˜
        function saveMemo() {
            const memo = document.getElementById('memoTextarea').value.trim();
            
            if (currentMemoType && currentMemoItem) {
                const storageKey = `chatbot_${currentMemoType}`;
                const items = JSON.parse(localStorage.getItem(storageKey) || '[]');
                
                const index = items.findIndex(i => {
                    if (currentMemoType === 'searches') {
                        return i.query === currentMemoItem.query && i.timestamp === currentMemoItem.timestamp;
                    }
                    if (currentMemoType === 'auths') {
                        return i.info === currentMemoItem.info;
                    }
                    if (currentMemoType === 'links') {
                        return i.url === currentMemoItem.url;
                    }
                    if (currentMemoType === 'keywords') {
                        return i.keyword === currentMemoItem.keyword;
                    }
                    return false;
                });
                
                if (index !== -1) {
                    items[index].memo = memo;
                    localStorage.setItem(storageKey, JSON.stringify(items));
                }
                
                loadHistory();
            }
            
            closeMemoModal();
        }

        // Escã‚­ãƒ¼ã§ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeMemoModal();
            }
        });

        // ã‚µãƒãƒªãƒ¼ã®å±•é–‹/æŠ˜ã‚ŠãŸãŸã¿
        function toggleSummary() {
            const content = document.getElementById('summaryContent');
            const toggle = document.getElementById('summaryToggle');
            
            content.classList.toggle('expanded');
            toggle.classList.toggle('expanded');
        }

        // æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã«è‡ªå‹•å…¥åŠ›
        function fillSearchInput(text) {
            const input = document.getElementById('userInput');
            input.value = text;
            input.focus();
            
            const isMobile = window.innerWidth <= 768;
            if (!isMobile) {
                setTimeout(() => {
                    input.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }, 100);
            }
        }

        // å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢
        function clearAllData() {
            if (confirm('ã™ã¹ã¦ã®åˆ†æãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™ã‹?')) {
                localStorage.removeItem('chatbot_searches');
                localStorage.removeItem('chatbot_auths');
                localStorage.removeItem('chatbot_links');
                localStorage.removeItem('chatbot_keywords');
                loadHistory();
            }
        }

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
        function addMessage(text, isUser = false, isWarning = false) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'} ${isWarning ? 'warning-message' : ''}`;
            
            const avatarClass = isUser ? 'user-avatar' : 'bot-avatar';
            const avatarText = isUser ? 'YOU' : 'NL';
            const senderName = isUser ? 'ã‚ãªãŸ' : 'NeuroLife AI';
            
            messageDiv.innerHTML = `
                <div class="message-avatar ${avatarClass}">${avatarText}</div>
                <div class="message-content">
                    <div class="message-sender">${senderName}</div>
                    <div class="message-text">${text.replace(/\n/g, '<br>')}</div>
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            if (!isUser) {
                detectLinksInMessage(text);
            }
        }

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…ã®ãƒªãƒ³ã‚¯ã‚’æ¤œå‡º
        function detectLinksInMessage(text) {
            const hrefPattern = /href=["']([^"']+\.html)["']/gi;
            let match;
            
            while ((match = hrefPattern.exec(text)) !== null) {
                const url = match[1];
                if (siteLinks[url]) {
                    saveLink(url, siteLinks[url]);
                }
            }
            
            Object.keys(siteLinks).forEach(url => {
                if (text.includes(url)) {
                    saveLink(url, siteLinks[url]);
                }
            });
        }

        function showTypingIndicator() {
            document.getElementById('typingIndicator').classList.add('active');
        }

        function hideTypingIndicator() {
            document.getElementById('typingIndicator').classList.remove('active');
        }

        function getBotResponse(userMessage) {
            const message = userMessage.toLowerCase().trim();
            
            for (let key in responses) {
                if (message.includes(key)) {
                    return responses[key];
                }
            }
            
            return responses['default'];
        }

        function analyzeMessage(message) {
            const lowerMessage = message.toLowerCase();
            
            Object.keys(authKeywords).forEach(keyword => {
                if (lowerMessage.includes(keyword.toLowerCase())) {
                    const label = authKeywords[keyword];
                    saveAuth(keyword, label);
                }
            });
            
            const productCodePattern = /[A-Z]{2,3}-[A-Z0-9]+-[A-Z]+/gi;
            const matches = message.match(productCodePattern);
            if (matches) {
                matches.forEach(code => {
                    const normalizedCode = code.toUpperCase();
                    if (normalizedCode.includes('DL-X789') || normalizedCode === 'DL-X789-OMEGA') {
                        saveAuth('dl-x789-omega', 'åˆ¶é™è£½å“ã‚³ãƒ¼ãƒ‰');
                    }
                });
            }
            
            importantKeywords.forEach(keyword => {
                if (lowerMessage.includes(keyword.toLowerCase())) {
                    saveKeyword(keyword);
                }
            });
        }

        function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            
            if (message === '') return;
            
            saveSearch(message);
            analyzeMessage(message);
            
            addMessage(message, true);
            input.value = '';
            
            showTypingIndicator();
            
            setTimeout(() => {
                hideTypingIndicator();
                const response = getBotResponse(message);
                const isWarning = response.includes('âš ï¸');
                addMessage(response, false, isWarning);
            }, 1000 + Math.random() * 1000);
        }

        function sendQuickMessage(message) {
            document.getElementById('userInput').value = message;
            sendMessage();
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        window.addEventListener('DOMContentLoaded', loadHistory);
    </script>
</body>
</html>
